{"version":3,"sources":["webpack:///webpack/bootstrap 445249a2faa153d218d0","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///external \"lodash\"","webpack:///./src/app/models/User.js","webpack:///./src/index.js","webpack:///./src/globals/index.js","webpack:///./src/globals/modules.js","webpack:///external \"shery-logger\"","webpack:///external \"mongoose\"","webpack:///external \"mongoose-timestamp\"","webpack:///external \"async\"","webpack:///external \"validator\"","webpack:///external \"is-json\"","webpack:///external \"morgan\"","webpack:///external \"body-parser\"","webpack:///external \"path\"","webpack:///external \"request-promise-native\"","webpack:///external \"bcrypt\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"express\"","webpack:///external \"dotenv\"","webpack:///./src/globals/vars.js","webpack:///./src/config/env.js","webpack:///./src/config/project.js","webpack:///./src/config/database.js","webpack:///./src/app/routes/index.js","webpack:///./src/app/routes/requests.js","webpack:///./src/app/middlewares/Auth.js","webpack:///external \"regenerator-runtime\"","webpack:///./src/app/models/sensitive/Hash.js","webpack:///./src/app/middlewares/Token.js","webpack:///./src/app/controllers/RequestsController.js","webpack:///./src/app/middlewares/CORS.js","webpack:///./src/app/middlewares/ExpressPlugins.js","webpack:///./src/app/middlewares/isValid.js"],"names":["userSchema","mongoose","Schema","username","type","String","required","plugin","mongooseTimestamp","virtual","set","password","Hash","update","user","_id","hash","upsert","statics","authorize","Promise","resolve","reject","findOne","savedHash","bcrypt","compare","match","model","process","env","projectMode","console","config","activeLevel","intro","Name","Project","Description","Notes","Mode","app","express","use","bodyParser","json","routes","post","req","res","message","static","path","join","__dirname","next","err","Error","status","validSend","error","port","API_PORT","listen","info","Number","_","mapKeys","value","name","global","globals","sherylogger","require","async","validator","isJSON","logger","request","jwt","dotenv","dotenvPath","argv","forEach","val","index","array","DevProjectInfoKeys","omit","DB_USERNAME","DB_PASSWORD","DB_HOST","DB_PORT","DB_NAME","mongoOptions","useMongoClient","loginInfo","authSource","DB_AUTHSOURCE","uri","connect","db","connection","on","bind","once","log","Router","all","TOKENKEY","headers","api_token","verify","verified","key","auth","getUpdate","$set","doHash","hashSchema","SchemaTypes","ObjectId","ref","pre","basedCollection","useridKey","validationConfig","valid","userid","docid","validation","sign","JWT_SECRET","schema","doc","token","authenticationInfo","User","findById","result","send","url","query","errorFromIran","method","body","response","statusCode","CORS","header","validators","isValid","validate","findKeys","object","keys","foundKeys","notFoundKeys","push","objectValue","objectKey","pop","deepOmit","mapValues","o","requiredKeys","forbiddenKeys","missedKeys","notAllowedKeys","length","omitKeys","JSON","stringify","$__","_doc","defaultOmitKeys"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 445249a2faa153d218d0","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 1\n// module chunks = 0","/**\r\n *          .::USER MODEL::.\r\n * User Mongoose model\r\n * \r\n */\r\nimport Hash from './sensitive/Hash';\r\n\r\n\r\nvar userSchema = mongoose.Schema({\r\n\r\n\tusername: {\r\n\t\ttype: String,\r\n\t\trequired: true\r\n\t},\r\n});\r\n\r\nuserSchema.plugin(mongooseTimestamp);\r\n//UPDATING HASH WHEN PASSWORD IS CHANGED\r\nuserSchema.virtual('password').set(async function(password){\r\n\treturn await Hash.update({user:this._id},{user:this._id,hash:password},{upsert:true});\r\n})\r\n\r\n//AUTHORIZE USER\r\nuserSchema.statics.authorize= function(user){\r\n\treturn new Promise(async function(resolve,reject){\r\n\t\ttry{\r\n\t\t\t//FINDING HASH\r\n\t\t\tvar savedHash=await Hash.findOne({user:user._id});\r\n\t\t\tif(!savedHash) return reject(\"hash was not found\");\r\n\r\n\t\t\t//COMPARING PASSWORD AND HASH\r\n\t\t\tvar match=await bcrypt.compare(user.password,savedHash.hash);\r\n\t\t\tif(match) return resolve(true);\r\n\t\t\treturn resolve(false);\r\n\t\t}catch(e){\r\n\t\t\treturn reject(e);\r\n\t\t}\r\n\r\n\t})\r\n}\r\n\r\n\r\n\r\nexport default mongoose.model('User', userSchema);\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/User.js","/**\r\n *          .::MAIN FILE::.\r\n * \r\n * \r\n */\r\nimport vars from \"./globals\";\r\nimport './config/env';\r\n\r\nimport Project from './config/project';\r\nif (process.env.projectMode == \"Production\") {\r\n  //Don't print logs in production mode\r\n  console.config({\r\n    activeLevel: 2\r\n  })\r\n}\r\n//STARTUP\r\nconsole.intro({\r\n  Name: Project.Name,\r\n  Description: Project.Description,\r\n  Notes: Project.Notes,\r\n  Mode: process.env.projectMode\r\n});\r\n\r\nimport './config/database';\r\nimport routes from './app/routes';\r\nimport CORS from './app/middlewares/CORS';\r\nimport ExpressPlugins from './app/middlewares/ExpressPlugins';\r\n\r\nconst app = express();\r\n\r\n\r\n// Middlewares\r\napp.use(bodyParser.json());\r\napp.use(CORS);\r\napp.use(ExpressPlugins);\r\n\r\n// Routes\r\nroutes.post('/', (req, res) => res.json({\r\n  message: Project.Name+ ' API'\r\n}));\r\napp.use('/', routes);\r\napp.use(express.static(path.join(__dirname, '../public')));\r\n\r\napp.use(function (req, res, next) {\r\n  var err = new Error('Not Found');\r\n  err.status = 404;\r\n  next(err);\r\n});\r\napp.use((err,req,res,next)=>{\r\n  if(!err) return res.validSend(201,{});\r\n  if(!err.status)err.status=500;\r\n  return res.validSend(err.status,{error:err.message})\r\n})\r\n\r\nconst port = process.env.API_PORT || 3000;\r\n\r\n\r\napp.listen(port, (err) => {\r\n  if (err) {\r\n    console.error(err)\r\n  }\r\n\r\n  console.info(`listening on port`, Number(port))\r\n});\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\r\n *          .::GLOBALS::.\r\n * ALL DATA THAT SHOULD BE AVAILABLE EVERYWHERE\r\n * \r\n */\r\nimport _ from 'lodash';\r\nimport modules from './modules';\r\n_.mapKeys(modules, (value, name) => {\r\n    global[name] = value;\r\n})\r\n\r\nimport vars from './vars';\r\nglobal.globals = vars;\n\n\n// WEBPACK FOOTER //\n// ./src/globals/index.js","/**\r\n *          .::GLOBAL MODULES::.\r\n * Require any module here and it will be available everywhere\r\n * \r\n */\r\nexport default {\r\n    //Sherytech modules\r\n    sherylogger:require('shery-logger'),\r\n    \r\n    //Data storing modules\r\n    mongoose: require('mongoose'),\r\n    mongooseTimestamp:require('mongoose-timestamp'),\r\n    \r\n    //Tool modules\r\n    _: require('lodash'),\r\n    async: require('async'),\r\n    validator: require('validator'),\r\n    isJSON:require('is-json'),\r\n    logger: require('morgan'),\r\n    bodyParser: require('body-parser'),\r\n    path:require('path'),\r\n    request:require('request-promise-native'),\r\n\r\n    //Encryption modules\r\n    bcrypt:require('bcrypt'),\r\n    jwt:require('jsonwebtoken'),\r\n    \r\n    //Server handling modules\r\n    express: require('express'),\r\n\r\n    //Configuration modules\r\n    dotenv:require('dotenv'),\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/globals/modules.js","module.exports = require(\"shery-logger\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"shery-logger\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 8\n// module chunks = 0","module.exports = require(\"mongoose-timestamp\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose-timestamp\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"async\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"async\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"validator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"validator\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"is-json\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"is-json\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"request-promise-native\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request-promise-native\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 20\n// module chunks = 0","/**\r\n *          .::GLOBAL VARIABLES::. \r\n * \r\n */\r\nexport default {\r\n    //Add global variables here\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/globals/vars.js","/**\r\n *          .::ENVIRONMENT PARSING::.\r\n * Parsing .env files and defining Project mode(Development, Production)\r\n * \r\n */\r\nlet dotenvPath = \"../../.dev.env\"\r\nlet projectMode = \"Development\"\r\nprocess\r\n  .argv\r\n  .forEach((val, index, array) => {\r\n    switch (val) {\r\n      case \"--production\":\r\n        projectMode = \"Production\"\r\n        return dotenvPath = '../../.env';\r\n        break;\r\n\r\n      //Add more commands here\r\n      default:\r\n    }\r\n  });\r\n\r\ndotenv.config({\r\n  path: path.resolve(__dirname, dotenvPath),\r\n});\r\nprocess.env.projectMode=projectMode;\n\n\n// WEBPACK FOOTER //\n// ./src/config/env.js","/**\r\n *          .::PROJECT CONFIGURATION::.\r\n * Project configuration and all project's information are defined here.\r\n * \r\n */\r\nlet Project = {\r\n\r\n    Name: \"fromiran\",\r\n    Description: \"A middle finger from Iran to all banned systems.\",\r\n    Notes: [\"Some Notes to think\", \"List of works to do\", ]\r\n\r\n}\r\nlet DevProjectInfoKeys = [\r\n    \"Notes\",\r\n    //Add Key names that shouldn't appear in production mode\r\n]\r\nif (process.env.projectMode == \"Production\") {\r\n    Project = _.omit(Project, DevProjectInfoKeys)\r\n}\r\nexport default Project;\n\n\n// WEBPACK FOOTER //\n// ./src/config/project.js","/**\r\n *          .::DATABASE CONFIGURATION::.\r\n * Connecting to Mongo Server and Database Configuration\r\n * \r\n */\r\nmongoose.Promise = global.Promise;\r\n\r\nconst {\r\n\tDB_USERNAME,\r\n\tDB_PASSWORD,\r\n\tDB_HOST,\r\n\tDB_PORT,\r\n\tDB_NAME\r\n} = process.env;\r\n\r\nconst mongoOptions = {\r\n\tuseMongoClient: true,\r\n};\r\n\r\n//GENERATING MONGODB URI\r\nvar loginInfo = \"\";\r\nvar authSource = \"\";\r\nif (DB_USERNAME) {\r\n\tloginInfo = DB_USERNAME + \":\" + DB_PASSWORD + \"@\";\r\n\tauthSource = \"?authSource=\" + DB_AUTHSOURCE;\r\n}\r\nvar uri = \"mongodb://\" + loginInfo + DB_HOST + \":\" + DB_PORT + \"/\" + DB_NAME + authSource;\r\n\r\n//CONNECTING TO MONGODB SERVER\r\nmongoose.connect(uri, mongoOptions);\r\nconst db = mongoose.connection;\r\n\r\n//LOGS\r\ndb.on('error', console.error.bind(console, 'MongoDB connection error:'));\r\ndb.once('open', () => console.log('Connected to mongo server.'));\n\n\n// WEBPACK FOOTER //\n// ./src/config/database.js","/**\r\n *          .::ROUTES::.\r\n * All routes are imported here.\r\n * \r\n */\r\nconst routes = express.Router();\r\nimport requests from './requests';\r\n\r\n//USING ROUTES\r\nroutes.use('/req', requests);\r\n\r\nexport default routes;\n\n\n// WEBPACK FOOTER //\n// ./src/app/routes/index.js","/**\r\n *          .::REQUESTS ROUTES::.\r\n * All request's apis are routed here.\r\n * \r\n */\r\nconst routes = express.Router();\r\n\r\nimport Auth from '../middlewares/Auth';\r\nimport {\r\n\tsend,\r\n\t\r\n} from '../controllers/RequestsController'\r\n\r\n//ENDPOINTS\r\nroutes.all('/', send);\r\n\r\n\r\n\r\n\r\nexport default routes;\n\n\n// WEBPACK FOOTER //\n// ./src/app/routes/requests.js","/**\r\n *          .::AUTHENTICATION::.\r\n * Authentication operations belong here.\r\n * \r\n */\r\nimport User from '../models/User';\r\nimport {\r\n\tverify\r\n} from './Token';\r\n//The KEY that has token\r\nconst TOKENKEY=\"x-access-token\"\r\n\r\n//API AUTHENTICATION\r\nexport default async function auth(req, res, next) {\r\n\t//Getting Token\r\n\tif (req.headers[TOKENKEY]) var api_token = req.headers[TOKENKEY];\r\n\t//TOKENNOTFOUND Handling\r\n\tif (!api_token) return res.validSend(401, \"The following keys are required in request header: \\n \"+TOKENKEY+\"\\n\")\r\n\t//Verifying token\r\n\tvar verified = await verify(api_token);\r\n\t//Verifying token error handling\r\n\tif (verified.error) return res.validSend(401, verified);\r\n\t//Adding verified user information to request object.\r\n\t_.mapKeys(verified, (value, key) => {\r\n\t\treturn req[key] = value;\r\n\t});\r\n\r\n\tnext();\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/Auth.js","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 28\n// module chunks = 0","/**\r\n *          .::HASH MODEL::.\r\n * User's password hashes model\r\n * \r\n */\r\n\r\nvar hashSchema = mongoose.Schema({\r\n\r\n    user: {\r\n        type: mongoose.SchemaTypes.ObjectId,\r\n        ref: \"User\"\r\n    },\r\n    hash: String,\r\n});\r\n\r\nhashSchema.plugin(mongooseTimestamp)\r\n\r\n//HASHING PASSWORD\r\nasync function doHash(next) {\r\n    try {\r\n        var password = this.getUpdate().$set.hash;\r\n        this.getUpdate().$set.hash = await bcrypt.hash(password, 10);\r\n        next();\r\n    } catch (e) {\r\n        next(e);\r\n    }\r\n}\r\nhashSchema.pre('update', doHash)\r\nhashSchema.pre('findOneAndUpdate', doHash)\r\n\r\n\r\nexport default mongoose.model('Hash', hashSchema);\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/sensitive/Hash.js","/**\r\n *          .::TOKENIZATION::.\r\n * Generating, Verifying and all related operations to Token are here.\r\n * \r\n */\r\nimport User from '../models/User';\r\n\r\n//TOKEN CONFIGURATION\r\n/**\r\n *  basedCollection: Name of the schema that token is generating from it.\r\n *  useridKey: Name of the field that userid is stored there in the told collection\r\n * \r\n * Example: {\r\n *      collection: 'Device',\r\n *      useridKey: 'userid'\r\n *  } \r\n * This example generates token based on user's Device.\r\n */\r\nlet config = {\r\n    basedCollection: 'User',\r\n    useridKey: '_id'\r\n}\r\n\r\nlet validationConfig = () => {\r\n    if (!config) return {\r\n        valid: false,\r\n        error: \"config is not defined\"\r\n    }\r\n    if (!config.basedCollection) return {\r\n        valid: false,\r\n        error: \"collection name is not defined\"\r\n    }\r\n    if (!config.useridKey) return {\r\n        valid: false,\r\n        error: \"userid key is not defined\"\r\n    }\r\n    return {\r\n        valid: true\r\n    }\r\n\r\n}\r\n//GENERATING TOKEN\r\n/**\r\n *  @param {string} userid User unique identifier\r\n *  @param {string} docid Optional- Unique Identifier of basedCollection's document that is related to user. If it's null, this function will find it in database automatically. \r\n */\r\nexport default async(userid, docid) => {\r\n    //CHECKING TOKENIZATION CONFIG\r\n    var validation = validationConfig();\r\n    if (!validation.valid) return {\r\n        error: validation.error\r\n    };\r\n    var {\r\n        basedCollection,\r\n        useridKey\r\n    } = config;\r\n    //IF BASEDCOLLECTION IS USER, USERID AND _ID SHOULD BE SAME.\r\n    if (basedCollection == 'User') return await jwt.sign({\r\n        userid,\r\n        basedCollection,\r\n        _id: userid\r\n    },process.env.JWT_SECRET);\r\n    let schema = mongoose.model(basedCollection);\r\n    //IF DOCID IS NOT DEFINED, FIND IT IN BASEDCOLLECTION\r\n    if (!docid) {\r\n        let doc = await schema.findOne({\r\n            [useridKey]: userid\r\n        });\r\n        if (!doc) return {\r\n            error: \"No \" + basedCollection + \"'s document with passed \" + useridKey + \" was found.\"\r\n        }\r\n        docid=doc._id;\r\n    }\r\n    //GENERATING TOKEN\r\n    return await jwt.sign({\r\n        userid,\r\n        basedCollection,\r\n        docid\r\n    },process.env.JWT_SECRET);\r\n\r\n}\r\n//VERIFYING TOKEN\r\nexport let verify=async(token)=>{\r\n    try{\r\n        //VERIFYING\r\n        var authenticationInfo=await jwt.verify(token,process.env.JWT_SECRET);\r\n        var {basedCollection,userid,docid} =authenticationInfo;\r\n        //FINDING USER OBJECT\r\n        var user=await User.findById(userid);\r\n        var result={User:user};\r\n\r\n        if(basedCollection!='User'){\r\n        //FINDING BASEDCOLLECTION DOCUMENT\r\n        var schema=mongoose.model(basedCollection);\r\n        var doc=await schema.findById(docid);\r\n        result[basedCollection]=doc;\r\n        }\r\n        //RETURNING FOUND OBJECTS\r\n        return result\r\n        \r\n    }catch(e){\r\n        //INVALID TOKEN\r\n        return {error:\"Token is not valid.\"}\r\n    }\r\n\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/Token.js","/**\r\n *          .::REQUEST CONTROLLER::.\r\n * All related operations to Request belong here. \r\n * \r\n */\r\n\r\n/*          POST /api/req/send            */\r\nexport let send = async(req, res) => {\r\n    var {\r\n        url\r\n    } = req.query;\r\n    if(!url)return res.status(400).json({errorFromIran:\"url is missed\"})\r\n    var {method,body,headers}=req;\r\n    try{\r\n\r\n        var response=await request({\r\n            url,\r\n            json:body,\r\n            headers,\r\n            method\r\n            \r\n        });\r\n        return res.status(200).json(response);\r\n    }catch(e){\r\n        if(!e.statusCode)e.statusCode=500;\r\n        return res.status(e.statusCode).json(e)\r\n    }\r\n    \r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/controllers/RequestsController.js","/**\r\n *          .::CORS::.\r\n * Cross-Origin Resource Sharing configuration\r\n * \r\n */\r\nexport default function CORS(req, res, next) {\r\n  res.header('Access-Control-Allow-Origin', '*');\r\n  res.header('Access-Control-Allow-Methods', 'PUT, GET, HEAD, POST, DELETE, OPTIONS');\r\n  res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, X-Api-Token, Content-Type, Accept, Authorization, Access-Control-Allow-Credentials');\r\n  res.header('Access-Control-Allow-Credentials', 'true');\r\n  next();\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/CORS.js","/**\r\n *          .::EXPRESS PLUGINS::.\r\n * Express plugins and all adding data to req and res are here.\r\n * \r\n */\r\nimport isValid from './isValid';\r\nexport default (req, res, next)=> {\r\n\tvalidators(req,res);\r\n\r\n\tnext();\r\n}\r\n//ADDING REQUEST AND RESPONSE VALIDATORS TO REQUEST\r\nlet validators=(req,res)=>{\r\n\tres.validSend=isValid.res;\r\n\treq.res=res;\r\n\treq.validate=isValid.req;\r\n\t\r\n\t\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/ExpressPlugins.js","/**\r\n *          .::VALIDATION::.\r\n * All validation operations belong here.\r\n * \r\n */\r\n\r\n\r\n\r\n\r\n/**\r\n * Returns a json object that has `foundKeys` and `notFoundKeys`\r\n * @param {*} object\r\n * @param {*[]} keys keys to find in `object`\r\n */\r\nlet findKeys = (object, keys) => {\r\n    var foundKeys = [];\r\n    var notFoundKeys = [];\r\n    keys.forEach(key => {\r\n        notFoundKeys.push(key);\r\n        _.mapKeys(object, (objectValue, objectKey) => {\r\n            if (key == objectKey) {\r\n                if (object[key] && object[key] != null && object[key] != \"\") {\r\n\r\n                    foundKeys.push(key);\r\n                    notFoundKeys.pop();\r\n                }\r\n            }\r\n        });\r\n    });\r\n    return {\r\n        foundKeys,\r\n        notFoundKeys\r\n    };\r\n}\r\nlet deepOmit = (object, keys) => {\r\n    object=_.omit(object,keys);\r\n    \r\n    return _.mapValues(object,(o)=>{\r\n        if(isJSON(o,true)) return deepOmit(o,keys);\r\n        return o;\r\n    })\r\n}\r\n/**\r\n * request validation\r\n * @param requiredKeys {string[]} Keys that are required in req.body\r\n * @param forbiddenKeys {string[]} Keys that are not allowed to be in req.body\r\n * \r\n */\r\nexport function req(requiredKeys, forbiddenKeys) {\r\n    var req = this;\r\n    var {\r\n        res\r\n    } = req;\r\n    var {\r\n        body\r\n    } = req;\r\n    if (!requiredKeys) requiredKeys = [];\r\n    if (!forbiddenKeys) forbiddenKeys = [];\r\n\r\n\r\n\r\n    var missedKeys = findKeys(body, requiredKeys).notFoundKeys;\r\n    var notAllowedKeys = findKeys(body, forbiddenKeys).foundKeys;\r\n\r\n\r\n\r\n    var error = \"\";\r\n    if (missedKeys.length > 0) error = \"The following keys are required in request body:\\n \" + _.join(missedKeys, \" , \") + \"\\n\";\r\n    if (forbiddenKeys.length > 0) error = \"The following keys are forbidden in request body:\\n\" + _.join(forbiddenKeys, \" , \") + \"\\n\";\r\n\r\n    if (error == \"\") return true;\r\n    res.validSend(400, {\r\n        error\r\n    });\r\n    return false;\r\n\r\n\r\n}\r\n/**\r\n * \r\n * @param {number} status http status code\r\n * @param {*} body response body\r\n * @param {string[]} omitKeys Optional - keys to omit from response body\r\n */\r\nexport function res(status, body, omitKeys) {\r\n    if (!status) status = 200;\r\n    if (body)\r\n        if (validator.isJSON(JSON.stringify(body))) {\r\n\r\n            if (body[\"$__\"]) body = body.$__;\r\n\r\n            if (body._doc) body = body._doc;\r\n\r\n            var defaultOmitKeys = [\"__v\"];\r\n            if (!omitKeys) omitKeys = defaultOmitKeys;\r\n            body = deepOmit(body, omitKeys);\r\n\r\n        }\r\n\r\n    return this.status(status).json(body);\r\n\r\n\r\n\r\n}\r\n\r\nexport default {\r\n    req,\r\n    res\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/isValid.js"],"sourceRoot":""}